{% load i18n %}
{% load account socialaccount %}

{% block content %}

<h1>{% trans "Sign In" %}</h1>

{% get_providers as socialaccount_providers %}
{% if socialaccount_providers %}
<p>{% blocktrans with site.name as site_name %}Please sign in with one
  of your existing third party accounts. Or, <a href="{{ signup_url }}">sign up</a>
  for a {{ site_name }} account and sign in below:{% endblocktrans %}</p>

<div class="socialaccount_ballot">



</div>

{% include "socialaccount/snippets/login_extra.html" %}

{% else %}
<p>{% blocktrans %}If you have not created an account yet, then please
  <a href="{{ signup_url }}">sign up</a> first.{% endblocktrans %}</p>
{% endif %}

<form id="formlogin" class="login">
  {% csrf_token %}
  <div class="form-group"><label for="id_login">Correo electr칩nico:</label> <input type="email" name="login"
      class="form-control" placeholder="Correo electr칩nico" autofocus="autofocus" required="" id="id_login"></div>
  <div class="form-group"><label for="id_password">Contrase침a:</label>
    <input class="form-control" type="password" name="password" placeholder="Contrase침a" required="" id="id_password">
  </div>
  {% if redirect_field_value %}
  <input type="hidden" name="{{ redirect_field_name }}" value="{{ redirect_field_value }}" />
  {% endif %}
  <a class="button secondaryAction" href="{% url 'account_reset_password' %}">{% trans "Forgot Password?" %}</a>
  <button class="btn btn-primary" type="submit">{% trans "Sign In" %}</button>
</form>
<div class="login-or" style="text-align: center;">-{% trans 'or' %}-</div>

<div class="socialaccount_ballot">


</div>
<a title="Google" class="socialaccount_provider google" href="/accounts/google/login/?process=login">
  <div class="google-btn">
    <div class="google-icon-wrapper">
      <img class="google-icon" src="https://upload.wikimedia.org/wikipedia/commons/5/53/Google_%22G%22_Logo.svg" />
    </div>
    <p class="btn-text">Ingresar con Google</p>
  </div>
</a>
{% load  static %}
<style>
  .jconfirm {
    z-index: 500 !important;
  }
</style>
<!-- <script src="{% static 'js/jquery-3.4.1.min.js' %}"></script> -->

<script>
  $("#formlogin").submit(function (e) {
    console.log("ENtro al form");
    e.preventDefault();
    $.ajax({
      type: "POST",
      url: "{% url 'base:login' %}",
      data: $(this).serialize(),

      success: function (response) {

        console.log(response);
        if (!response.stat) {
          TopMessage(response.error, "error")
          $("#id_password").val("")
        }
        else {
          location.href = '{% url "base:index" %}';
        }
      }
    });
  });
</script>
{% endblock %}