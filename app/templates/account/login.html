{% load i18n %}
{% load account socialaccount %}

{% block content %}
<div class="container">
<h1>{% trans "Sign In" %}</h1>

{% get_providers as socialaccount_providers %}
{% if socialaccount_providers %}
<!-- <p>{% blocktrans with site.name as site_name %}Please sign in with one
  of your existing third party accounts. Or, <a href="{{ signup_url }}">sign up</a>
  for a {{ site_name }} account and sign in below:{% endblocktrans %}</p> -->

<div class="socialaccount_ballot">



</div>

{% include "socialaccount/snippets/login_extra.html" %}

{% else %}
<p>{% blocktrans %}If you have not created an account yet, then please
  <a href="{{ signup_url }}">sign up</a> first.{% endblocktrans %}</p>
{% endif %}

<form id="formlogin" class="login">
  {% csrf_token %}

  <div class="md-form">
    <i class="fas fa-user prefix"></i>
    <input type="email" name="login" class="form-control" required=""
      id="materialLoginFormEmail">
    <label for="materialLoginFormEmail">E-mail</label>

  </div>
  <div class="md-form">
    <i class="fas fa-lock prefix"></i>
    <input class="form-control" type="password" name="password"  required="" id="materialLoginFormPassword">
    <label for="materialLoginFormPassword">Password</label>

  </div>
  {% if redirect_field_value %}
  <input type="hidden" name="{{ redirect_field_name }}" value="{{ redirect_field_value }}" />
  {% endif %}


  <a class="button secondaryAction" href="{% url 'account_reset_password' %}">{% trans "¿Olvidaste tu contraseña?" %}</a>
  <button class="btn btn-primary btn-block my-4" type="submit">Entrar</button>

  <!-- Register -->
  <p class="text-center">No eres miembro?
      <a href="">Registrate aquí</a>
  </p>

  <!-- Social login -->
</form>
<div class="login-or" style="text-align: center;">-{% trans 'or' %}-</div>

<div class="socialaccount_ballot">


</div>
<a title="Google" class="socialaccount_provider google" href="/accounts/google/login/?process=login">
  <div class="google-btn justify-content-center">
    <div class="google-icon-wrapper">
      <img class="google-icon" src="https://upload.wikimedia.org/wikipedia/commons/5/53/Google_%22G%22_Logo.svg" />
    </div>
    <p class="btn-text">Ingresar con Google</p>
  </div>
</a>
<style>
  .jconfirm {
    z-index: 1031 !important;
  }
</style>

</div>
{% endblock %}

{% block js_page %}
<script>
  $("#formlogin").submit(function (e) {
    console.log("ENtro al form");
    e.preventDefault();
    $.ajax({
      type: "POST",
      url: "{% url 'base:login' %}",
      data: $(this).serialize(),

      success: function (response) {

        console.log(response);
        if (!response.stat) {
          TopMessage(response.error, "error")
          $("#id_password").val("")
        }
        else {
          location.href = '{% url "base:index" %}';
        }
      }
    });
  });
</script>
{% endblock js_page %}